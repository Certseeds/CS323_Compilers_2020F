.data
_prompt: .asciiz "Enter an integer:"
_ret: .asciiz "\n"

_sum: .word 0
_p2: .word 0
_n: .word 0
_p1: .word 0
_p3: .word 0
_t0: .word 0
_t1: .word 0
_t2: .word 0
_t3: .word 0
_t4: .word 0
_t5: .word 0
_t6: .word 0
_t7: .word 0
_t8: .word 0
_t9: .word 0
_t10: .word 0
_t11: .word 0
_t12: .word 0
_t13: .word 0
_t14: .word 0
_t15: .word 0
_t16: .word 0
_t17: .word 0
_t18: .word 0
_t19: .word 0

.globl main
.text
read:
    li $v0, 4
    la $a0, _prompt
    syscall
    li $v0, 5
    syscall
    jr $ra
write:
    li $v0, 1
    syscall
    li $v0, 4
    la $a0, _ret
    syscall
    move $v0, $0
    jr $ra

hanoi:
    li   $t0,1
    sw   $t0,_t0

    lw   $t0,_n
    lw   $t1,_t0
    beq  $t0,$t1,label1

    j label2

label1:
    li   $t0,10000
    sw   $t0,_t1

    lw   $t0,_p1
    lw   $t1,_t1
    mul  $t2,$t0,$t1
    sw   $t2,_t2

    lw   $t0,_t2
    lw   $t1,_p3
    add  $t2,$t0,$t1
    sw   $t2,_t3

    addi $sp, $sp, -8 ### push stack to store $ra
    sw   $a0,  0($sp) ## store $a0
    sw   $ra,  4($sp) ### store $ra
    lw   $t0,_t3
    move $a0,  $t0
    jal  write ### invoke write
    lw   $ra,  4($sp) ## read $ra
    lw   $a0,  0($sp) ## store $a0
    addi $sp, $sp, 8

    j label3

label2:
    li   $t0,1
    sw   $t0,_t4

    lw   $t0,_n
    lw   $t1,_t4
    sub  $t2,$t0,$t1
    sw   $t2,_t5

    li   $t0,10000
    sw   $t0,_t7

    lw   $t0,_p1
    lw   $t1,_t7
    mul  $t2,$t0,$t1
    sw   $t2,_t8

    lw   $t0,_t8
    lw   $t1,_p3
    add  $t2,$t0,$t1
    sw   $t2,_t9

    addi $sp, $sp, -8 ### push stack to store $ra
    sw   $a0,  0($sp) ## store $a0
    sw   $ra,  4($sp) ### store $ra
    lw   $t0,_t9
    move $a0,  $t0
    jal  write ### invoke write
    lw   $ra,  4($sp) ## read $ra
    lw   $a0,  0($sp) ## store $a0
    addi $sp, $sp, 8

    li   $t0,1
    sw   $t0,_t10

    lw   $t0,_n
    lw   $t1,_t10
    sub  $t2,$t0,$t1
    sw   $t2,_t11

label3:
    li   $t0,0
    sw   $t0,_t13

    lw   $t0,_t13
    move $v0,$t0
    jr $ra

main:
    li   $t0,3
    sw   $t0,_t14

    lw   $t0,_t14
    sw   $t0,_sum

    li   $t0,1
    sw   $t0,_t15

    li   $t0,2
    sw   $t0,_t16

    li   $t0,3
    sw   $t0,_t17

    li   $t0,0
    sw   $t0,_t19

    lw   $t0,_t19
    move $v0,$t0
    jr $ra

